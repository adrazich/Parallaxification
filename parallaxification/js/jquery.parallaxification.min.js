/**
* Parallaxification is a jQuery gallery plugin for easy parallax scrolling including infinite scrolling.
* \version 0.6 alpha - this plugin is currently under development
* \author Anna Drazich
* \copyright (c) 2012 Anna Drazich
* Dual licensed under the MIT and GPL licenses.
* MIT License: https://github.com/adrazich/parallaxification/blob/master/MIT-License.txt
* GPL License: https://github.com/adrazich/parallaxification/blob/master/GPL-License.txt
* Website: http://www.initanna.com/parallaxification/
* Github: https://github.com/adrazich/parallaxification
*/
function CalculateSpeed(a){1E3<a&&(a=1E3);-1E3>a&&(a=-1E3);return 200*(a- -1E3)/2E3+0}
(function(a,h){a.fn.parallax=function(l){var c=_defaults=a.extend({z:null,useZSpeed:!1,direction:"horizontal",easing:"linear",useVelocity:!1,speed:500,animationSpeed:500,repeat:!1,selector:this.selector,onAnimationStart:function(){},onAnimationEnd:function(){}},l),d=viewport=null;return this.each(function(){function l(){c.onAnimationStart.call(this)}function m(){c.onAnimationEnd.call(this)}function k(){if(c.repeat&&null!==b){var e=Math.ceil(viewport.width/d.totalWidth),f=Math.ceil(viewport.width/
c.speed);if(b.number.screen<e){for(var g=0;g<e-b.number.screen;g++)j(!1);b.number.screen=e}if(b.number.side<f){for(g=0;g<f-b.number.side;g++)j(!0),j(!1);b.number.side=f}0>a(c.selector).eq(b.begin).offset().left+d.totalWidth*b.number.side&&(tmp=a(c.selector).eq(b.end).offset().left+d.totalWidth,a(c.selector).eq(b.begin).stop().css("margin-left",tmp+"px"),e=b.begin+1>a(c.selector).length-1?0:b.begin+1,b.end=b.begin,b.begin=e);a(c.selector).eq(b.end).offset().left-(d.totalWidth*(b.number.side-1)+d.totalWidth)>
viewport.width&&(tmp=a(c.selector).eq(b.begin).offset().left-d.totalWidth,a(c.selector).eq(b.end).stop().css("margin-left",tmp+"px"),e=0>b.end-1?a(c.selector).length-1:b.end-1,b.begin=b.end,b.end=e)}}function j(e){var e=!1===e?!1:!0,f=a(i).clone(!0);if(e){var e=a(c.selector).eq(b.begin),g=e.offset().left-d.totalWidth;f.css("margin-left",g+"px");f.insertBefore(e);f=b.begin-1;b.begin=0>f?0:f;b.end++}else e=a(c.selector).eq(b.end),g=e.offset().left+d.totalWidth,e.offset(),f.css("margin-left",g+"px"),
f.insertAfter(e),f=b.end+1,b.end=f>a(c.selector).length-1?a(c.selector).length-1:f}var i=this,b=null;viewport={width:a(h).width(),height:a(h).height()};d={width:a(i).width(),totalWidth:0,animating:!1,offset:0,margin:{left:parseInt(a(i).css("margin-left")),right:parseInt(a(i).css("margin-right"))}};c.useZSpeed&&(c.speed=CalculateSpeed(c.z));c.offset="vertical"==c.direction?a(i).css("margin-top"):a(i).css("margin-left");d.totalWidth=d.margin.left+d.margin.right+d.width;c.repeat&&(b={begin:0,end:0,number:{side:0,
screen:1},animate:{to:0,curr:0}},k(),j(!0),j(!1));a(h).on("resize",function(){viewport.width=a(h).width();viewport.height=a(h).height();k()});a(h).on("mousewheel",function(b,f){clearTimeout(a.data(this,"timer-"+c.selector));a.data(this,"timer-"+c.selector,setTimeout(function(){d.animating=false;m();a(c.selector).stop(true,false)},100));var g={},g=f>0?"-=":"+=",h=1;c.useVelocity&&(h=Math.abs(f));g=c.direction=="vertical"?{marginTop:g+c.speed*h+"px"}:{marginLeft:g+c.speed*h+"px"};k();if(!d.animating){d.animating=
true;l();a(c.selector).animate(g,c.animationSpeed,c.easing,function(){d.animating=false;m()})}});setInterval(function(){d.animating&&k()},250)})}})(jQuery,window,document);